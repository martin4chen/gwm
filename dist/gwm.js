"use strict";var now=new Date,fullYear=now.getFullYear(),month=9<=now.getMonth()?now.getMonth()+1:"0"+(now.getMonth()+1),date=now.getDate(),dateConvert=function(){return""+fullYear+month+date},classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},createClass=function(){function a(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}}(),Watermark=function t(e){var n=e.txt,a=void 0===n?"":n,r=e.x,o=void 0===r?0:r,i=e.y,c=void 0===i?50:i,s=e.font,l=void 0===s?"microsoft yahe":s,h=e.color,d=void 0===h?"#000":h,u=e.fontSize,f=void 0===u?12:u,v=e.alpha,w=void 0===v?.1:v,m=e.width,p=void 0===m?158:m,g=e.height,y=void 0===g?100:g,b=e.angle,x=void 0===b?-15:b;classCallCheck(this,t),this.txt=a||dateConvert()+" 内部资料 请勿外传",this.width=p,this.height=y,this.x=o,this.y=c,this.font=l,this.fontSize=f,this.color=d,this.alpha=w,this.angle=x},CanvasWay=function(){function a(t){classCallCheck(this,a);var e=(this.watermark=t).width,n=t.height;this.canvas=document.createElement("canvas"),this.canvas.setAttribute("width",e),this.canvas.setAttribute("height",n)}return createClass(a,[{key:"render",value:function(){var t=this.watermark,e=t.txt,n=t.x,a=t.y,r=t.width,o=t.height,i=t.font,c=t.color,s=t.fontSize,l=t.alpha,h=t.angle,d=this.canvas.getContext("2d");return d.clearRect(0,0,r,o),d.textBaseline="top",d.textAlign="left",d.fillStyle=c,d.globalAlpha=l,d.font=s+"px "+i,d.translate(n,a),d.rotate(Math.PI/180*h),d.translate(-n,-a-s),d.fillText(e,n,a+s),this.canvas.toDataURL()}}]),a}();function setStyle(t,e,n){t.style[e]=n}var bindCSS=function(e,n){return Object.keys(n).forEach(function(t){return setStyle(e,t,n[t])})},ElementWay=function(){function e(t){classCallCheck(this,e),this.watermark=t}return createClass(e,[{key:"_createItem",value:function(){var t=this.watermark,e=t.txt,n=t.x,a=t.y,r=t.font,o=t.color,i=t.fontSize,c=t.alpha,s=t.angle,l=t.width,h=t.height,d=document.createElement("div");bindCSS(d,{position:"relative",width:l,height:h,flex:"0 0 "+l+"px",overflow:"hidden",pointerEvents:"none"});var u=document.createElement("span");return u.innerHTML=e,bindCSS(u,{position:"absolute",top:a+"px",left:n+"px",fontFamily:r,fontSize:i+"px",color:o,lineHeight:1.5,opacity:c,fontWeight:400,transform:"rotate("+s+"deg)",transformOrigin:"0 0",userSelect:"none",whiteSpace:"nowrap",overflow:"hidden"}),d.appendChild(u),d}},{key:"render",value:function(){var t=this.watermark,e=t.width,n=t.height,a=document.documentElement||document.body,r=a.clientWidth,o=a.clientHeight,i=Math.ceil(r/e),c=Math.ceil(o/n),s=document.createElement("div");bindCSS(s,{display:"flex",flexWrap:"wrap",width:e*i+"px",height:n*c+"px"});for(var l=0;l<i*c;l++)s.appendChild(this._createItem());return s}}]),e}(),SvgWay=function(){function e(t){classCallCheck(this,e),this.watermark=t}return createClass(e,[{key:"render",value:function(){var t=this.watermark,e=t.txt,n=t.x,a=t.y,r=t.width,o=t.height,i=t.color,c=t.font,s=t.fontSize,l='<svg xmlns="http://www.w3.org/2000/svg" width="'+r+'px" height="'+o+'px">\n                <text x="'+n+'px" y="'+a+'px" dy="'+s+'px"\n                    text-anchor="start"\n                    stroke="'+i+'"\n                    stroke-opacity="'+t.alpha+'"\n                    fill="none"\n                    transform="rotate('+t.angle+","+n+" "+a+')"\n                    font-weight="100"\n                    font-size="'+s+'"\n                    font-family="'+c+'"\n                    >\n                    '+e+"\n                </text>\n            </svg>";return"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(l)))}}]),e}(),_id="__gwm_"+ +new Date,MutationObserver=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,observer=function(t){if(!MutationObserver)return!1;var e=document.getElementById(_id),n=new MutationObserver(t);return n.observe(e,{characterData:!0,attributes:!0,childList:!0,subtree:!0}),n},disconnect=function(t){return t.disconnect()},creator=function(){var t=document.getElementById(_id);t&&document.body.removeChild(t);var e=document.createElement("div");return bindCSS(e,{position:"fixed",top:0,left:0,width:"100%",height:"100%",overflow:"hidden",zIndex:-100,backgroundRepeat:"no-repeat"}),e.id=_id,e},CANVAS="canvas",SVG="svg",ELEMENT="element",wayFactory=function(t,e){var n=[CANVAS,SVG,ELEMENT],a=null;switch(t&&(t=t.toLowerCase(),t=0<=n.indexOf(t)?t:""),t||(t="canvas"),t){case CANVAS:a=new CanvasWay(e);break;case SVG:a=new SvgWay(e);break;default:a=new ElementWay(e)}return a};!function(){var c={creation:function(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=(c.opts=e).mode,a=e.watch,r=creator(),o=new Watermark(e);t=wayFactory(n,o).render(),n===ELEMENT?r.appendChild(t):r.style.background='url("'+t+'")';var i=document.body.firstChild;return i?document.body.insertBefore(r,i):document.body.appendChild(r),!1!==a&&(c.observer=c.observing()),c},observing:function(){return observer(function(){return c.creation(c.opts)})},cancel:function(){return disconnect(c.observer)}};window.gwm=c}();
//# sourceMappingURL=gwm.js.map
