{"version":3,"file":"gwm.js","sources":["../lib/watermark.js","../lib/core/canvas.js","../lib/helpers/bindCSS.js","../lib/core/element.js","../lib/core/svg.js","../lib/index.js"],"sourcesContent":["export default class Watermark {\n    constructor({\n                    txt = '',\n                    x = 0,\n                    y = 50,\n                    xSpace = 0,\n                    ySpace = 0,\n                    font = 'microsoft yahe',\n                    color = '#000',\n                    fontSize = 12,\n                    alpha = 0.5,\n                    width = 158,\n                    height = 100,\n                    angle = -6\n                }) {\n        this.txt = txt\n        this.x = x\n        this.y = y\n        this.xSpace = xSpace // x轴间隔\n        this.ySpace = ySpace // y轴间隔\n        this.font = font\n        this.color = color\n        this.fontSize = fontSize // 字体大小\n        this.alpha = alpha // 透明度\n        this.width = width\n        this.height = height\n        this.angle = angle\n    }\n}","export default class CanvasWay {\n    constructor(watermark) {\n        this.watermark = watermark\n        let {width, height, xSpace, ySpace} = watermark\n        this.canvas = document.createElement('canvas');\n        this.canvas.setAttribute('width', width + xSpace);\n        this.canvas.setAttribute('height', height + ySpace);\n    }\n\n    render() {\n        let {txt, x, y, width, height, xSpace, ySpace, font, color, fontSize, alpha, angle} = this.watermark\n        let ctx = this.canvas.getContext('2d');\n        ctx.textBaseline = 'top';\n        ctx.textAlign = 'left'\n        ctx.fillStyle = color;\n        ctx.globalAlpha = alpha;\n        ctx.font = `${fontSize}px ${font}`\n        ctx.rotate(Math.PI / 180 * angle);\n        ctx.translate(-15, ySpace / 2 + y /2 );\n        ctx.fillText(txt, xSpace / 2 + x, ySpace / 2 + y);\n        return this.canvas.toDataURL();\n    }\n}","function setStyle(elem, key, value) {\n    elem.style[key] = value\n}\n\nexport default (elem, css) => Object.keys(css).forEach(key => setStyle(elem, key, css[key]))","import bindCSS from '../helpers/bindCSS'\n\nexport default class ElementWay {\n    constructor(watermark) {\n        this.watermark = watermark\n    }\n\n    _createItem() {\n        let {txt, x, y, font, color, fontSize, alpha, angle, width, height, xSpace, ySpace} = this.watermark\n        const item = document.createElement('div');\n        bindCSS(item, {\n            position: 'relative',\n            width, height,\n            flex: `0 0 ${width}px`,\n            margin: `${xSpace / 2}px ${ySpace / 2}px`,\n            overflow: 'hidden'\n        })\n        let span = document.createElement('span');\n        span.innerHTML = txt\n        bindCSS(span, {\n            position: 'absolute',\n            top: `${y}px`,\n            left: `${x}px`,\n            fontFamily: font,\n            fontSize: `${fontSize}px`,\n            color: color,\n            opacity: alpha,\n            transform: `rotate(${angle}deg)`,\n            userSelect: 'none',\n            whiteSpace: 'nowrap',\n            overflow: 'hidden'\n        })\n        item.appendChild(span)\n        return item;\n    }\n\n    render() {\n        const {width, height, xSpace, ySpace} = this.watermark\n        const {clientWidth, clientHeight} = document.documentElement || document.body\n        const column = Math.ceil(clientWidth / (width + xSpace))\n        const rows = Math.ceil(clientHeight / (height + ySpace))\n        const wrap = document.createElement('div');\n        bindCSS(wrap, {\n            display: 'flex',\n            flexWrap: 'wrap',\n            width: `${(width + xSpace) * column}px`,\n            height: `${(height + ySpace) * rows}px`\n        })\n        for (let i = 0; i < column * rows; i++) {\n            wrap.appendChild(this._createItem());\n        }\n        return wrap;\n    }\n}","export default class SvgWay {\n    constructor(watermark) {\n        this.watermark = watermark\n    }\n\n    render() {\n        const {txt, x, y, width, height, color, xSpace, ySpace, font, fontSize, alpha, angle} = this.watermark\n        const svgStr =\n            `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${(width + xSpace)}px\" height=\"${(height + ySpace)}px\">\n                <text x=\"${x}px\" y=\"${y}px\" dy=\"12px\"\n                    text-anchor=\"start\"\n                    stroke=\"${color}\"\n                    stroke-width=\"1\"\n                    stroke-opacity=\"${alpha}\"\n                    fill=\"none\"\n                    transform=\"rotate(${angle}, ${x} ${y})\"\n                    font-weight=\"100\"\n                    font-size=\"${fontSize}\"\n                    font-family=\"${font}\"\n                    >\n                    ${txt}\n                </text>\n            </svg>`;\n        return `data:image/svg+xml;base64,${window.btoa(unescape(encodeURIComponent(svgStr)))}`;\n    }\n}","import Watermark from './watermark'\nimport CanvasWay from './core/canvas'\nimport ElementWay from './core/element'\nimport SvgWay from './core/svg.js'\n\n\nconst gwmDiv = document.createElement('div');\nconst gwmStyle = {\n    position: 'absolute',\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n    width: '158px',\n    height: '100px',\n    overflow: 'hidden',\n    // backgroundImage: `url(\"${img}\")`,\n    backgroundRepeat: 'no-repeat'\n}\nfor (let key in gwmStyle) {\n    gwmDiv.style[key] = gwmStyle[key]\n}\n\n\nconst w = new Watermark({txt: '20180727 内部资料 请勿外传', angle: -15, color: '#ff0000'})\n//\nconst img = new CanvasWay(w).render()\ngwmDiv.style.backgroundImage = `url(\"${img}\")`\ndocument.body.appendChild(gwmDiv)\n//\n// w.color='#2196f3'\n// const img = new SvgWay(w).render()\n// gwmDiv.style.backgroundImage = `url(\"${img}\")`\n// document.body.appendChild(gwmDiv)\n\n\n// w.color = '#000'\n// const elementWay = new ElementWay(w)\n// gwmDiv.appendChild(elementWay.render())\n// document.body.appendChild(gwmDiv)"],"names":["Watermark","txt","x","y","xSpace","ySpace","font","color","fontSize","alpha","width","height","angle","CanvasWay","watermark","canvas","document","createElement","setAttribute","ctx","getContext","textBaseline","textAlign","fillStyle","globalAlpha","rotate","Math","PI","translate","fillText","toDataURL","setStyle","elem","key","value","style","css","Object","keys","forEach","ElementWay","item","span","innerHTML","appendChild","documentElement","body","clientWidth","clientHeight","column","ceil","rows","wrap","i","_createItem","SvgWay","svgStr","window","btoa","unescape","encodeURIComponent","gwmDiv","gwmStyle","w","img","render","backgroundImage"],"mappings":"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"}